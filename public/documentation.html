<!DOCTYPE html>
<head>
    <title>Movie API</title>
</head>

<body>
    <p>
        <h1>Documentation</h1>
        <h2>Description:</h2>
        This is my first body of work <br> 
        with server-side code and building an API<br> 
        (specifically, a REST API).<br> 
        I built this web app with node.js and JavaScript.<br>
        The app provides users with some details<br>
        about different movies, directors, and genres.
    </p>
    <p>
        <h2>Endpoint Map</h2><br>
        <div>
            <h3>Movies:</h3>
    
            <h4>Endpoint: '/movies'</h4>  
            <ul>
                <li>Method: GET</li>
                <li>Logic: Gets all Movies</li>
                <li>Parameters: None</li>
                <li>Mongoose Query: 
                    app.get('/movies', (req, res) => {
                        Movies.find()
                </li>
                <li>Data expected in request body:</li>
                <p>None</p>
                <li>Data expected in response:</li>
                <p>A JSON object of all the movies</p>
            </ul>


            <h4>Endpoint: '/movies/:title'</h4>  
            <ul>
                <li>Method: GET</li>
                <li>Logic: Gets movie by title</li>
                <li>Parameters: title</li>
                <li>Mongoose Query: 
                    app.get('/movies/:title', (req, res) => {
                        const { title } = req.params;
                        Movies.findOne({ Title: title })
                </li>
                <li>Data expected in request body:</li>
                <p>None</p>
                <li>Data expected in response:</li>
                <p>A JSON object a specific movie</p>
            </ul>



            <h4>Endpoint: '/movies/genre/:genreName'</h4>  
            <ul>
                <li>Method: GET</li>
                <li>Logic: Gets movies by genre</li>
                <li>Parameters: genreName</li>
                <li>Mongoose Query: 
                    app.get('/movies/genre/:genreName', (req, res) => {
                        Movies.find({ 'Genre.Name': req.params.genreName })
                </li>
                <li>Data expected in request body:</li>
                <p>None</p>
                <li>Data expected in response:</li>
                <p>A JSON object of a specific genre</p>
            </ul>


            <h4>Endpoint: '/movies/directors/:directorName'</h4>  
            <ul>
                <li>Method: GET</li>
                <li>Logic: get data about a director</li>
                <li>Parameters: directorName</li>
                <li>Mongoose Query: 
                    app.get('/movies/directors/:directorName', (req, res) => {
                        Movies.findOne({ 'Director.Name': req.params.directorName })
                </li>
                <li>Data expected in request body:</li>
                <p>None</p>
                <li>Data expected in response:</li>
                <p>A JSON object of a specific director</p>
            </ul>


        </div><br><br>


        <div>    
            <h3>Users:</h3>
                
            <h4>Endpoint: '/users'</h4>  
            <ul>
                <li>Method: POST</li>
                <li>Logic: Registers new user</li>
                <li>Parameters: name</li>
                <li>Mongoose Query: 
                    Users.findOne({ Username: req.body.Username })
                    .then((user) => {
                        if (user) {
                        return res.status(400).send(req.body.Username + 'already exists');
                        } else {
                        Users
                            .create({
                            Username: req.body.Username,
                            Password: req.body.Password,
                            Email: req.body.Email,
                            Birthday: req.body.Birthday
                        })
                </li>
                <li>Data expected in request body:</li>
                <p>JSON object of the new user: {"id": "", "name": "", "favoriteMovies": ""}</p>
                <li>Data expected in response:</li>
                <p>JSON object of the new user: {JSON object of the new user: {"id": "", "name": "", "favoriteMovies": ""}</p>
            </ul>


            <h4>Endpoint: '/users/:Username'</h4>
            <ul>
                <li>Method: PUT</li>
                <li>Logic: Update a user's information by username</li>
                <li>Parameters: Username</li>
                <li>Mongoose Query: 
                    app.get('/users/:Username', (req, res) => {
                        Users.findOne({username: req.params.Username })
                </li>
                <li>Data expected in request body: JSON object with the updated user information:</li>
                <pre>
                {
                    "Username": "NewUsername",
                    "Password": "NewPassword",
                    "Email": "NewEmail",
                    "Birthdate": "NewBirthdate"
                }
                </pre>
                <li>Data expected in response: JSON object containing the updated user information</li>
            </ul>


            <h4>Endpoint: '/users/:id/:movieTitle'</h4>  
            <ul>
                <li>Method: POST</li>
                <li>Logic: Adds movie to favoriteMovies</li>
                <li>Parameters:</li>
                <li>Mongoose Query: 
                    app.post('/users/:Username/movies/:MovieID', async (req, res) => {
                        try {
                          const { Username, MovieID } = req.params;
                      
                          const updatedUser = await Users.findOneAndUpdate(
                </li>
                <ul> 
                    <li>id</li>
                    <li>movieTitle</li>
                </ul>
                <li>Data expected in request body:</li>
                <p>None</p>
                <li>Data expected in response:</li>
                <p>A JSON of the user</p>
            </ul>


            <h4>Endpoint: '/users/:id/:movieTitle'</h4>  
            <ul>
                <li>Method: DELETE</li>
                <li>Logic: Removes movie from favoriteMovies</li>
                <li>Parameters:</li>
                <ul>
                    <li>id</li>
                    <li>movieTitle</li>
                </ul>
                <li>Mongoose Query: 
                    app.delete(
                    '/users/:userName/movies/:MovieID',
                    (req, res) => {
                      Users.findOneAndUpdate(
                        { Username: req.params.userName },
                        {
                          $pull: { FavoriteMovies: req.params.MovieID }
                        },
                        { new: true }
                      )</li>
                <li>Data expected in request body:</li>
                <p>None</p>
                <li>Data expected in response:</li>
                <p>Text that shows the movie has been removed</p>
            </ul>


            <h4>Endpoint: '/users/:id/'</h4>  
            <ul>
                <li>Method: DELETE</li>
                <li>Logic: Unregisters user</li>
                <li>Parameters: id</li>
                <li>Mongoose Query: 
                    app.delete('/users/:Username', (req, res) => {
                        Users.findOneAndRemove({ Username: req.params.Username })
                </li>
                <li>Data expected in request body:</li>
                <p>None</p>
                <li>Data expected in response:</li>
                <p>Text showing the user has been removed</p>
            </ul>


            <h4>Endpoint: '/users/name/:userName'</h4>
            <ul>
                <li>Method: GET</li>
                <li>Logic: Gets user by username</li>
                <li>Parameters: userName</li>
                <li>Mongoose Query: 
                    app.get('/users/:Username', (req, res) => {
                        Users.findOne({username: req.params.Username })
                </li>
                <li>Data expected in request body: None</li>
                <li>Data expected in response: A JSON object of a specific user</li>
            </ul>


            <h4>Endpoint: '/users'</h4>
            <ul>
                <li>Method: GET</li>
                <li>Logic: Gets all users</li>
                <li>Parameters: None</li>
                <li>Mongoose Query: 
                    app.get('/users', (req, res) => {
                        Users.find()
                </li>
                <li>Data expected in request body: None</li>
                <li>Data expected in response: A JSON object containing all users</li>
            </ul>


        
            
        </div>
               
            
    </p>

</body>